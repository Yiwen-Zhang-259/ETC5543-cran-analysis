# Analysis

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
library(tidyverse)
library(pkgsearch)
library(jsonlite)
library(grid)
library(cranlogs)
library(ctv)
library(lubridate)
```

## Daily top 15 downloaded packages 

```{r readcran}
url <- "http://cran.rstudio.com/web/packages/packages.rds"
db <- readRDS(url(url)) %>% 
as.data.frame()

#cran2012_10_01 <- read_csv("data/2012-10-01 (1).csv")
#cran2013_10_01 <- read_csv("data/2013-10-01.csv")
#cran2014_10_01 <- read_csv("data/2014-10-01.csv")
#cran2015_10_01 <- read_csv("data/2015-10-01.csv")
#cran2016_10_01 <- read_csv("data/2016-10-01.csv")
#cran2017_10_01 <- read_csv("data/2017-10-01.csv")
#cran2018_10_01 <- read_csv("data/2018-10-01.csv")
#cran2019_10_01 <- read_csv("data/2019-10-01.csv")

#save(cran2012_10_01, file=here::here("data/cran2012_10_01.rda"))
#save(cran2013_10_01, file=here::here("data/cran2013_10_01.rda"))
#save(cran2014_10_01, file=here::here("data/cran2014_10_01.rda"))
#save(cran2015_10_01, file=here::here("data/cran2015_10_01.rda"))
#save(cran2016_10_01, file=here::here("data/cran2016_10_01.rda"))
#save(cran2017_10_01, file=here::here("data/cran2017_10_01.rda"))
#save(cran2018_10_01, file=here::here("data/cran2018_10_01.rda"))
#save(cran2019_10_01, file=here::here("data/cran2019_10_01.rda"))

load("data/cran2012_10_01.rda")
load("data/cran2013_10_01.rda")
load("data/cran2014_10_01.rda")
load("data/cran2015_10_01.rda")
load("data/cran2016_10_01.rda")
load("data/cran2017_10_01.rda")
load("data/cran2018_10_01.rda")
load("data/cran2019_10_01.rda")
```

```{r rstudiolist}
# filter the packages maintained by R studio

pkg_rstusio <- db %>%
  filter(grepl('RStudio', Author)) %>%
  select(Package) %>%
  rename(package = Package)

```

```{r contributorlist}
# filter the packages whose author is from R core group or on the secondary list

pkg_secondary <- db %>%
  filter(grepl('Douglas Bates|John Chambers|Peter Dalgaard|Robert Gentleman|Kurt Hornik|Ross Ihaka|Tomas Kalibera|Michael Lawrence|Friedrich Leisch|Uwe Ligges|Thomas Lumley|Martin Maechler|Martin Morgan|Paul Murrell|Brian Ripley|Deepayan Sarkar|Duncan Temple Lang|Luke Tierney|Simon Urbanek|Martyn Plummer', Author))%>%
  filter(!grepl('Guido Masarotto|Duncan Murdoch|Henrik Bengtsson|Roger Bivand|Ben Bolker|David Brahm|Vince Carey|Saikat DebRoy|Matt Dowle|Dirk Eddelbuettel|Claus Ekstrom|John Fox|Paul Gilbert|Yu Gong|Gabor Grothendieck|Frank E Harrell Jr|Peter M. Haverty|Torsten Hothorn|Robert King|Kjetil Kjernsmo|Roger Koenker|Philippe Lambert|Jan de Leeuw|Jim Lindsey|Patrick Lindsey|Catherine Loader| Gordon Maclean|Arni Magnusson|John Maindonald|David Meyer|Ei-ji Nakama|Jens Oehlschägel|Steve Oncley|Richard O’Keefe|Hubert Palme|Roger D. Peng|José C. Pinheiro|Tony Plate|Anthony Rossini| Jonathan Rougier|Petr Savicky|Günther Sawitzki|Marc Schwartz|Arun Srinivasan|Detlef Steuer|Bill Simpson|Gordon Smyth|Adrian Trapletti|Terry Therneau|Rolf Turner|Bill Venables|Gregory R. Warnes| Andreas Weingessel|Morten Welinder|James Wettenhall|Simon Wood|and Achim Zeileis', Author)) %>%
  select(Package) %>%
  rename(package = Package)

```

```{r top20activelist}
# filter the packages developed by top 20 prolific maintainers
pkg_20maintainer <- db %>% 
  filter(stringr::str_detect(Author, 'Hadley Wickham|Yihui Xie|Dirk Eddelbuettel|Jeroen Ooms|Achim Zeileis|Scott Chamberlain|Gabor Csardi|Jeroen Ooms|ORPHANED|Thomas J. Leeper|Bob Rudis|Henrik Bengtsson|Kurt Hornik|Oliver Keyes|Martin Maechler|Richard Cotton|Robin K. S. Hankin|Simon Urbanek|Kirill Muller|Torsten Hothorn|Paul Gilbert') )%>%
  select(Package) %>%
  rename(package = Package)
```

```{r filterlist}
# exclude the packages in the above three lists
cran2019_10_01_new <- cran2019_10_01 %>%
     filter(!(package %in% pkg_20maintainer$package)) %>%
     filter(!(package %in% pkg_secondary$package)) %>%
     filter(!(package %in% pkg_rstusio$package)) 

cran2018_10_01_new <- cran2018_10_01 %>%
     filter(!(package %in% pkg_20maintainer$package)) %>%
     filter(!(package %in% pkg_secondary$package)) %>%
     filter(!(package %in% pkg_rstusio$package)) 


cran2017_10_01_new <- cran2017_10_01 %>%
     filter(!(package %in% pkg_20maintainer$package)) %>%
     filter(!(package %in% pkg_secondary$package)) %>%
     filter(!(package %in% pkg_rstusio$package)) 

cran2016_10_01_new <- cran2016_10_01 %>%
     filter(!(package %in% pkg_20maintainer$package)) %>%
     filter(!(package %in% pkg_secondary$package)) %>%
     filter(!(package %in% pkg_rstusio$package)) 

cran2015_10_01_new <- cran2015_10_01 %>%
     filter(!(package %in% pkg_20maintainer$package)) %>%
     filter(!(package %in% pkg_secondary$package)) %>%
     filter(!(package %in% pkg_rstusio$package)) 

cran2014_10_01_new <- cran2014_10_01 %>%
     filter(!(package %in% pkg_20maintainer$package)) %>%
     filter(!(package %in% pkg_secondary$package)) %>%
     filter(!(package %in% pkg_rstusio$package)) 

cran2013_10_01_new <- cran2013_10_01 %>%
     filter(!(package %in% pkg_20maintainer$package)) %>%
     filter(!(package %in% pkg_secondary$package)) %>%
     filter(!(package %in% pkg_rstusio$package)) 

cran2012_10_01_new <- cran2012_10_01 %>%
     filter(!(package %in% pkg_20maintainer$package)) %>%
     filter(!(package %in% pkg_secondary$package)) %>%
     filter(!(package %in% pkg_rstusio$package)) 
```


```{r  cran20121001}
cran2012_1001 <- cran2012_10_01_new %>%
  drop_na() %>%
  count(package) %>%
  arrange(desc(n)) %>%
  head(15) 
  
cran2012_1001$package <- as.vector(cran2012_1001$package) #get rid of factors

cran2012_1001$package = factor(cran2012_1001$package,cran2012_1001$package)

p1 <- ggplot(data = cran2012_1001) +
  geom_bar(stat="identity", aes(x = package, y = n)) +
  labs(
       title = "Top 15 downloaded packages on 2012-10-01") +
  theme_minimal()  +
  theme(panel.grid.major = element_blank()) +
  theme(
  axis.text=element_text(size=10),
  axis.title=element_text(size=12,face="bold"),
  axis.text.x = element_text(angle = 55, hjust = 1))
```


```{r cran20131001}
cran2013_1001 <- cran2013_10_01_new %>%
  drop_na() %>%
  count(package) %>%
  arrange(desc(n)) %>%
  head(15) 
  
cran2013_1001$package <- as.vector(cran2013_1001$package) #get rid of factors

cran2013_1001$package = factor(cran2013_1001$package,cran2013_1001$package)

 p2 <- ggplot(data = cran2013_1001) +
  geom_bar(stat="identity", aes(x = package, y = n)) +
  labs(
       title = "Top 15 downloaded packages on 2013-10-01") +
  theme_minimal()  +
  theme(panel.grid.major = element_blank()) +
  theme(
  axis.text=element_text(size=10),
  axis.title=element_text(size=12,face="bold"),
  axis.text.x = element_text(angle = 55, hjust = 1))
```

```{r cran20141001}
cran2014_1001 <- cran2014_10_01_new %>%
  drop_na() %>%
  count(package) %>%
  arrange(desc(n)) %>%
  head(15) 
  
cran2014_1001$package <- as.vector(cran2014_1001$package) #get rid of factors

cran2014_1001$package = factor(cran2014_1001$package,cran2014_1001$package)

p3 <- ggplot(data = cran2014_1001) +
  geom_bar(stat="identity", aes(x = package, y = n)) +
  labs(
       title = "Top 15 downloaded packages on 2014-10-01") +
  theme_minimal()  +
  theme(panel.grid.major = element_blank()) +
  theme(
  axis.text=element_text(size=10),
  axis.title=element_text(size=12,face="bold"),
  axis.text.x = element_text(angle = 55, hjust = 1))
```

```{r cran20151001}
cran2015_1001 <- cran2015_10_01_new %>%
  drop_na() %>%
  count(package) %>%
  arrange(desc(n)) %>%
  head(15) 
  
cran2015_1001$package <- as.vector(cran2015_1001$package) #get rid of factors

cran2015_1001$package = factor(cran2015_1001$package,cran2015_1001$package)

p4 <- ggplot(data = cran2015_1001) +
  geom_bar(stat="identity", aes(x = package, y = n)) +
  labs(
       title = "Top 15 downloaded packages on 2015-10-01") +
  theme_minimal()  +
  theme(panel.grid.major = element_blank()) +
  theme(
  axis.text=element_text(size=10),
  axis.title=element_text(size=12,face="bold"),
  axis.text.x = element_text(angle = 55, hjust = 1))
```

```{r cran20161001}
cran2016_1001 <- cran2016_10_01_new %>%
  drop_na() %>%
  count(package) %>%
  arrange(desc(n)) %>%
  head(15) 
  
cran2016_1001$package <- as.vector(cran2016_1001$package) #get rid of factors

cran2016_1001$package = factor(cran2016_1001$package,cran2016_1001$package)

p5 <- ggplot(data = cran2016_1001) +
  geom_bar(stat="identity", aes(x = package, y = n)) +
  labs(
       title = "Top 15 downloaded packages on 2016-10-01") +
  theme_minimal()  +
  theme(panel.grid.major = element_blank()) +
  theme(
  axis.text=element_text(size=10),
  axis.title=element_text(size=12,face="bold"),
  axis.text.x = element_text(angle = 55, hjust = 1))
```

```{r cran20171001}
cran2017_1001 <- cran2017_10_01_new %>%
  drop_na() %>%
  count(package) %>%
  arrange(desc(n)) %>%
  head(15) 
  
cran2017_1001$package <- as.vector(cran2017_1001$package) #get rid of factors

cran2017_1001$package = factor(cran2017_1001$package,cran2017_1001$package)

p6 <- ggplot(data = cran2017_1001) +
  geom_bar(stat="identity", aes(x = package, y = n)) +
  labs(
       title = "Top 15 downloaded packages on 2017-10-01") +
  theme_minimal()  +
  theme(panel.grid.major = element_blank()) +
  theme(
  axis.text=element_text(size=10),
  axis.title=element_text(size=12,face="bold"),
  axis.text.x = element_text(angle = 55, hjust = 1))
```

```{r cran20181001}
cran2018_1001 <- cran2018_10_01_new %>%
  drop_na() %>%
  count(package) %>%
  arrange(desc(n)) %>%
  head(15) 
  
cran2018_1001$package <- as.vector(cran2018_1001$package) #get rid of factors

cran2018_1001$package = factor(cran2018_1001$package,cran2018_1001$package)

p7 <- ggplot(data = cran2018_1001) +
  geom_bar(stat="identity", aes(x = package, y = n)) +
  labs(
       title = "Top 15 downloaded packages on 2018-10-01") +
  theme_minimal()  +
  theme(panel.grid.major = element_blank()) +
  theme(
  axis.text=element_text(size=10),
  axis.title=element_text(size=12,face="bold"),
  axis.text.x = element_text(angle = 55, hjust = 1))
```

```{r cran20191001}
cran2019_1001 <- cran2019_10_01_new %>%
  drop_na() %>%
  count(package) %>%
  arrange(desc(n)) %>%
  head(15) 
  
cran2019_1001$package <- as.vector(cran2019_1001$package) #get rid of factors

cran2019_1001$package = factor(cran2019_1001$package,cran2019_1001$package)

p8 <- ggplot(data = cran2019_1001) +
  geom_bar(stat="identity", aes(x = package, y = n)) +
  labs(
       title = "Top 15 downloaded packages on 2019-10-01") +
  theme_minimal()  +
  theme(panel.grid.major = element_blank()) +
  theme(
  axis.text=element_text(size=10),
  axis.title=element_text(size=12,face="bold"),
  axis.text.x = element_text(angle = 55, hjust = 1))
```


```{r compareby2year}
# display the daily top 15 popular packages on 10-01 of each year from 2012 to 2019
g1 <- ggplotGrob(p1)
g2 <- ggplotGrob(p2)
g12 <- rbind(g1, g2, size = "first")
g12$widths <- unit.pmax(g1$widths, g2$widths)
grid.newpage()
grid.draw(g12)

g3 <- ggplotGrob(p3)
g4 <- ggplotGrob(p4)
g34 <- rbind(g3, g4, size = "first")
g34$widths <- unit.pmax(g3$widths, g4$widths)
grid.newpage()
grid.draw(g34)

g5 <- ggplotGrob(p5)
g6 <- ggplotGrob(p6)
g56 <- rbind(g5, g6, size = "first")
g56$widths <- unit.pmax(g5$widths, g6$widths)
grid.newpage()
grid.draw(g56)

g7 <- ggplotGrob(p7)
g8 <- ggplotGrob(p8)
g78 <- rbind(g7, g8, size = "first")
g78$widths <- unit.pmax(g7$widths, g8$widths)
grid.newpage()
grid.draw(g78)
```

## Compare last two years' downloads with the release date

1. Packages for Time Series Analysis

It can be seen from Figure \@ref(fig:timeseries) that although package `fable` is older than `forecast`, its download count is much less than that of `forecast`.

And we could see that the most downloaded package is `zoo` published on 2021-03-09, and next is `forecast`. So we can see that among time series packages, the two packages with the highest downloads have relatively new release dates. At the same time, we also notice that the number of downloads of package `slider` with the latest release date is not ideal. This may be because it is too new, few people know about it, and people are used to the old package and probably tend not to use the new one. 

p.s. very interesting point : the most downloaded `zoo` does not have a github version, while the second downloaded `forecast` does have one.

```{r timeseries, fig.align = 'center', fig.cap="The older package 'fable' has less download count than that of package 'forecast'."}
forecast <- cran_downloads(package = "forecast", from = "2018-04-01", to = "2020-04-01") %>%
  summarise(package = package, count = sum(count)) %>%
  head(1)

fable <- cran_downloads(package = "fable", from = "2018-04-01", to = "2020-04-01") %>%
  summarise(package = package, count = sum(count)) %>%
  head(1)

zoo <- cran_downloads(package = "zoo", from = "2018-04-01", to = "2020-04-01") %>%
  summarise(package = package, count = sum(count)) %>%
  head(1)

tsibble <- cran_downloads(package = "tsibble", from = "2018-04-01", to = "2020-04-01") %>%
  summarise(package = package, count = sum(count)) %>%
  head(1)

slider <- cran_downloads(package = "slider", from = "2018-04-01", to = "2020-04-01") %>%
  summarise(package = package, count = sum(count)) %>%
  head(1)

tbrf <- cran_downloads(package = "tbrf", from = "2018-04-01", to = "2020-04-01") %>%
  summarise(package = package, count = sum(count)) %>%
  head(1)

roll <- cran_downloads(package = "roll ", from = "2018-04-01", to = "2020-04-01") %>%
  summarise(package = package, count = sum(count)) %>%
  head(1)

runner  <- cran_downloads(package = "runner", from = "2018-04-01", to = "2020-04-01") %>%
  summarise(package = package, count = sum(count)) %>%
  head(1)

runstats  <- cran_downloads(package = "runstats", from = "2018-04-01", to = "2020-04-01") %>%
  summarise(package = package, count = sum(count)) %>%
  head(1)

tsutils  <- cran_downloads(package = "tsutils", from = "2018-04-01", to = "2020-04-01") %>%
  summarise(package = package, count = sum(count)) %>%
  head(1)

feasts  <- cran_downloads(package = "feasts", from = "2018-04-01", to = "2020-04-01") %>%
  summarise(package = package, count = sum(count)) %>%
  head(1)


timeseries <- rbind(forecast,fable,zoo,tsibble,slider,tbrf,roll,runner,runstats,tsutils,feasts) %>%
  group_by(package) 

timeseries <- as.data.frame(timeseries)

release_date <- c("2021-03-11","2021-02-03","2021-03-09","2021-02-20","2021-03-23","2020-04-09","2020-07-13","2021-02-22","2019-11-14","2020-02-06","2021-03-22")


timeseries <- cbind(timeseries,release_date) 


timeseries %>%
  ggplot(aes(x = release_date, y = count,fill = package)) +
  geom_bar(stat = "identity") +
    labs( y = 'Download count',
    title = "Last two years' downloads with the release date",
    subtitle = "between fable and forecast") +
  scale_y_sqrt() + # to change the scale of y axis
  theme_minimal()  +
  theme(panel.grid.major = element_blank()) +
  theme(
  axis.text=element_text(size=10),
  axis.title=element_text(size=12,face="bold"),
  plot.title = element_text(h = 0.5),
  plot.subtitle = element_text(h = 0.5),
  axis.text.x = element_text(angle = 55, hjust = 1))
```

2. Bayesian packages for general model fitting

Let's have a look at the bayesian packages used for general model fitting. It can be seen from Figure \@ref(fig:bayesian) that the most downloaded packages are two with relatively late release dates : `arm` and `loo`. Then the two packages `bayesm` and `mcmc` with the earliest release date were moderately downloaded. At the same time, we can also notice that the package with the smallest downloads named `nimble` also comes from the relatively recent date.

Therefore, in this type of packages, we can say that the later the release date, the higher the download volume of the package. But there are still some special cases. That is even if the release date is later, the download volume is still not ideal, which may be due to other reasons.

```{r bayesian,fig.align = 'center', fig.cap="last two years' downloads with the release date for bayesian general model fitting packages."}
# select eight packages on Bayesian general model fitting, after filtering, seven left.
bayesian <- tibble(package = c("arm","BACCO","bayesm","LaplacesDemon","loo","MCMCpack","mcmc","nimble")) %>%
     filter(!(package %in% pkg_20maintainer$package)) %>%
     filter(!(package %in% pkg_secondary$package)) %>%
     filter(!(package %in% pkg_rstusio$package)) 

arm <- cran_downloads(package = "arm", from = "2018-04-01", to = "2020-04-01") %>%
  summarise(package = package, count = sum(count)) %>%
  head(1)

bayesm <- cran_downloads(package = "bayesm", from = "2018-04-01", to = "2020-04-01") %>%
  summarise(package = package, count = sum(count)) %>%
  head(1)

LaplacesDemon <- cran_downloads(package = "LaplacesDemon", from = "2018-04-01", to = "2020-04-01") %>%
  summarise(package = package, count = sum(count)) %>%
  head(1)

loo <- cran_downloads(package = "loo", from = "2018-04-01", to = "2020-04-01") %>%
  summarise(package = package, count = sum(count)) %>%
  head(1)

MCMCpack <- cran_downloads(package = "MCMCpack", from = "2018-04-01", to = "2020-04-01") %>%
  summarise(package = package, count = sum(count)) %>%
  head(1)

mcmc <- cran_downloads(package = "mcmc", from = "2018-04-01", to = "2020-04-01") %>%
  summarise(package = package, count = sum(count)) %>%
  head(1)

nimble <- cran_downloads(package = "nimble", from = "2018-04-01", to = "2020-04-01") %>%
  summarise(package = package, count = sum(count)) %>%
  head(1)


bayesian7 <- rbind(arm,bayesm,LaplacesDemon,loo,MCMCpack,mcmc,nimble) %>%
  group_by(package) 

bayesian7 <- as.data.frame(bayesian7)

release_date <- c("2020-07-27","2019-10-15","2020-02-06","2020-12-09","2021-01-20","2020-03-21","	2020-11-23")

bayesian7 <- cbind(bayesian7,release_date) 

bayesian7 <- bayesian7 %>%
  mutate(release_date = ymd(release_date))

#bayesian7$release_date <- factor(bayesian7$release_date, levels=c("2019-10-15", "2020-02-06", #"2020-03-21","2020-07-27","2020-11-23","2020-12-09","2021-01-20"))

bayesian7 %>%
  ggplot(aes(x = release_date, y = count,fill = package)) +
  geom_bar(stat = "identity") +
    labs( y = 'Download count',
          x = 'Relsease date',
    title = "Last two years' downloads with the release date",
    subtitle = "for bayesian packages") +
  theme_minimal()  +
  theme(panel.grid.major = element_blank()) +
  theme(
  axis.text=element_text(size=10),
  axis.title=element_text(size=12,face="bold"),
  plot.title = element_text(h = 0.5),
  plot.subtitle = element_text(h = 0.5)) 

```

3. Econometrics for basic linear regression

In order to test whether this is the case in other areas, let's turn our attention to econometrics packages for basic linear regression. 

It can be seen from Figure \@ref(fig:eco-lm) that the latest package `sandwich` has the highest downloads, while the downloads of `nonnest2` with the earliest release date is much lower than it.

This is very similar to Bayesian's case, that is, the latest packages tend to have higher downloads, with some special cases, such as the release date of packages whose downloads is highest or lowest may be in the middle position.

```{r eco-lm,fig.align = 'center', fig.cap="The latest package 'sandwich` has the highest downloads."}
# select eight packages on Econometrics basic linear regression, after filtering, three left.
eco_lm <- tibble(package = c("lmtest","sandwich ","nonnest2","pscl","skedastic")) %>%
     filter(!(package %in% pkg_20maintainer$package)) %>%
     filter(!(package %in% pkg_secondary$package)) %>%
     filter(!(package %in% pkg_rstusio$package)) 

sandwich <- cran_downloads(package = "sandwich", from = "2018-04-01", to = "2020-04-01") %>%
  summarise(package = package, count = sum(count)) %>%
  head(1)

nonnest2 <- cran_downloads(package = "nonnest2", from = "2018-04-01", to = "2020-04-01") %>%
  summarise(package = package, count = sum(count)) %>%
  head(1)

skedastic <- cran_downloads(package = "skedastic", from = "2018-04-01", to = "2020-04-01") %>%
  summarise(package = package, count = sum(count)) %>%
  head(1)

eco_lm <- rbind(sandwich,nonnest2,skedastic) %>%
  group_by(package) 

eco_lm <- as.data.frame(eco_lm)

release_date <- c("2020-10-02","2020-07-05","2020-08-28")

eco_lm <- cbind(eco_lm,release_date) 

eco_lm %>%
  ggplot(aes(x = release_date, y = count,fill = package)) +
  geom_bar(stat = "identity") +
    labs( y = 'Download count',
          x = 'Relsease date',
    title = "Last two years' downloads with the release date",
    subtitle = "for econometrics packages") +
  scale_y_sqrt() +
  theme_minimal()  +
  theme(panel.grid.major = element_blank()) +
  theme(
  axis.text=element_text(size=10),
  axis.title=element_text(size=12,face="bold"),
  plot.title = element_text(h = 0.5),
  plot.subtitle = element_text(h = 0.5)) 

```

4. trending packages

For trending packages, Figure \@ref(fig:trendingpkg) shows that the most downloaded package `proxy` is released on 2021-03-05, a quite new date, while the second downloaded `ncdf4` is released on a relatively past date 2019-10-23. In addition, the downloads of packages released before February 2020 is generally higher than later ones. 

```{r trendingpkg,fig.align = 'center', fig.cap="The highest downloaded package 'proxy' is released on 2021-03-05."}
# find the top 15 trending packages and filter, 13 left
trendpkg <- cran_trending() %>%
  head(15) %>%
  filter(!(package %in% pkg_20maintainer$package)) %>%
  filter(!(package %in% pkg_secondary$package)) %>%
  filter(!(package %in% pkg_rstusio$package)) 

ncdf4 <- cran_downloads(package = "ncdf4", from = "2018-04-01", to = "2020-04-01") %>%
  summarise(package = package, count = sum(count)) %>%
  head(1)

tree.interpreter <- cran_downloads(package = "tree.interpreter", from = "2018-04-01", to = "2020-04-01") %>%
  summarise(package = package, count = sum(count)) %>%
  head(1)

spatstat.linnet <- cran_downloads(package = "spatstat.linnet", from = "2018-04-01", to = "2020-04-01") %>%
  summarise(package = package, count = sum(count)) %>%
  head(1)

spatstat.core <- cran_downloads(package = "spatstat.core", from = "2018-04-01", to = "2020-04-01") %>%
  summarise(package = package, count = sum(count)) %>%
  head(1)

geospark <- cran_downloads(package = "geospark", from = "2018-04-01", to = "2020-04-01") %>%
  summarise(package = package, count = sum(count)) %>%
  head(1)

	
spatstat.geom <- cran_downloads(package = "spatstat.geom", from = "2018-04-01", to = "2020-04-01") %>%
  summarise(package = package, count = sum(count)) %>%
  head(1)

uplift <- cran_downloads(package = "uplift", from = "2018-04-01", to = "2020-04-01") %>%
  summarise(package = package, count = sum(count)) %>%
  head(1)

proxy <- cran_downloads(package = "proxy", from = "2018-04-01", to = "2020-04-01") %>%
  summarise(package = package, count = sum(count)) %>%
  head(1)

spatstat.sparse <- cran_downloads(package = "spatstat.sparse", from = "2018-04-01", to = "2020-04-01") %>%
  summarise(package = package, count = sum(count)) %>%
  head(1)

compareGroups <- cran_downloads(package = "compareGroups", from = "2018-04-01", to = "2020-04-01") %>%
  summarise(package = package, count = sum(count)) %>%
  head(1)
	
botor <- cran_downloads(package = "botor", from = "2018-04-01", to = "2020-04-01") %>%
  summarise(package = package, count = sum(count)) %>%
  head(1)

clickstream <- cran_downloads(package = "clickstream", from = "2018-04-01", to = "2020-04-01") %>%
  summarise(package = package, count = sum(count)) %>%
  head(1)

ClickClust <- cran_downloads(package = "ClickClust", from = "2018-04-01", to = "2020-04-01") %>%
  summarise(package = package, count = sum(count)) %>%
  head(1)

trendpkg <- rbind(ncdf4,tree.interpreter,spatstat.linnet,spatstat.core,geospark,	
spatstat.geom,uplift,proxy,spatstat.sparse,compareGroups,botor,clickstream,	
ClickClust) %>%
  group_by(package) 

trendpkg <- as.data.frame(trendpkg)

release_date <- c("2019-10-23","2020-02-05","2021-03-28","2021-03-23","2020-03-02","2021-03-22","2014-03-17","2021-03-05","2021-03-16","2021-03-29","2020-02-16","2020-01-30","2016-10-23")

trendpkg <- cbind(trendpkg,release_date) 

trendpkg %>%
  ggplot(aes(x = release_date, y = count,fill = package)) +
  geom_bar(stat = "identity") +
    labs( y = 'Download count',
          x = 'Relsease date',
    title = "Last two years' downloads with the release date",
    subtitle = "for top 13 trending packages") +
  scale_y_sqrt() +
  theme_minimal()  +
  theme(panel.grid.major = element_blank()) +
  theme(
  axis.text=element_text(size=10),
  axis.title=element_text(size=12,face="bold"),
  plot.title = element_text(h = 0.5),
  plot.subtitle = element_text(h = 0.5),
  axis.text.x = element_text(angle = 55, hjust = 1)) 

```
In conclusion, I'm surprised to find it's not that the earlier the package is released, the more downloads it has. It may be higher than the later packages in general, but the difference is not significant. And the most downloaded packages are almost from the latest date, which is reflected in bayesian, econometrics, time series and top trending packages.
