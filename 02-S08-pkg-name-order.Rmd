## compare download counts with alphabetical order of name

We will also have such experiences in our life. For example, when we go shopping in the supermarket, the goods placed in front of the shelves will be easier to attract our attention and be selected by us, because we will no longer want to look more under similar functions.

From the perspective of package name, in addition to the length, does the alphabetic order of the first letter also affect the download volume? For package with early alphabetic order will be placed at the first part of the list. To answer this question, we grouped the packages in 26-letter order, calculated the average downloads of each group, and then compared them.

```{block, type="discovery", echo = TRUE}
**Finding 1**: For 1000 random packages, the relationship between alphabetic order and download count is not obvious.
```

```{r}
library(available)
cran_names <- rownames(available:::available_packages(repos = available:::default_cran_repos)) %>%
  as.data.frame() 

colnames(cran_names)[1] <- "package"


  get_pkg_alphabetic <- function(df,letter1,letter2){
  
  pkg <- df %>%
  filter(str_detect(package, paste0(letter1)))%>%
  mutate(group = paste0(letter2))

  return(pkg)
  
  }
  
pkg_a <- get_pkg_alphabetic(cran_names,"^a|^A","A/a")
pkg_b <- get_pkg_alphabetic(cran_names,"^b|^B","B/b")
pkg_c <- get_pkg_alphabetic(cran_names,"^c|^C","C/c")
pkg_d <- get_pkg_alphabetic(cran_names,"^d|^D","D/d")
pkg_e <- get_pkg_alphabetic(cran_names,"^e|^E","E/e")
pkg_f <- get_pkg_alphabetic(cran_names,"^f|^F","F/f")
pkg_g <- get_pkg_alphabetic(cran_names,"^g|^G","G/g")
pkg_h <- get_pkg_alphabetic(cran_names,"^h|^H","H/h")
pkg_i <- get_pkg_alphabetic(cran_names,"^i|^I","I/i")
pkg_j <- get_pkg_alphabetic(cran_names,"^j|^J","J/j")
pkg_k <- get_pkg_alphabetic(cran_names,"^k|^K","K/k")
pkg_l <- get_pkg_alphabetic(cran_names,"^l|^L","L/l")
pkg_m <- get_pkg_alphabetic(cran_names,"^m|^M","M/m")
pkg_n <- get_pkg_alphabetic(cran_names,"^n|^N","N/n")
pkg_o <- get_pkg_alphabetic(cran_names,"^o|^O","O/o")
pkg_p <- get_pkg_alphabetic(cran_names,"^p|^P","P/p")
pkg_q <- get_pkg_alphabetic(cran_names,"^q|^Q","Q/q")
pkg_r <- get_pkg_alphabetic(cran_names,"^r|^R","R/r")
pkg_s <- get_pkg_alphabetic(cran_names,"^s|^S","S/s")
pkg_t <- get_pkg_alphabetic(cran_names,"^t|^T","T/t")
pkg_u <- get_pkg_alphabetic(cran_names,"^u|^U","U/u")
pkg_v <- get_pkg_alphabetic(cran_names,"^v|^V","V/v")
pkg_w <- get_pkg_alphabetic(cran_names,"^w|^W","W/w")
pkg_x <- get_pkg_alphabetic(cran_names,"^x|^X","X/x")
pkg_y <- get_pkg_alphabetic(cran_names,"^y|^Y","Y/y")
pkg_z <- get_pkg_alphabetic(cran_names,"^z|^Z","Z/z")

pkg_alphabetic <- rbind(pkg_a,pkg_b,pkg_c,pkg_d,pkg_e,pkg_f,pkg_g,pkg_h,pkg_i,pkg_j,pkg_k,pkg_l,pkg_m,pkg_n,pkg_o,pkg_p,pkg_q,pkg_r,pkg_s,pkg_t,pkg_u,pkg_v,pkg_w,pkg_x,pkg_y,pkg_z) %>%
  group_by(group)

```

```{r random-sample1}
# generate random sample with 500 packages for each alphabetic group
set.seed(2599)

n <- 500
df <- pkg_alphabetic
df$ID <- pkg_alphabetic$group

# in case of that any group has less than 500 packages
FUN <- function(x, n) {
    if (length(x) <= n) return(x)
    x[x %in% sample(x, n)]
}

pkg_alpha_sample <- df[unlist(lapply(split(1:nrow(df), df$ID), FUN, n = 500)), ]

  
pkg_alpha_sample1 <- pkg_alpha_sample %>%
  mutate(length_name = nchar(package)) %>%
  mutate(count = get_total_downloads(package)$count)%>%
  rowwise()%>%
  mutate(length_name = as.numeric(length_name)) 
```

```{r alpha-function}

get_downloads_alphabetic <- function(df){
  
  
  pkg_alphabetic <- function(df,letter1,letter2){
  
  pkg <- df %>%
  select(-length_name) %>%
  filter(str_detect(package, paste0(letter1)))%>%
  mutate(group = paste0(letter2))

  return(pkg)
  
  }
  
 avg_downloads_a <- avg_downloads_alphabetic(df,"^a|^A")
 avg_downloads_b <- avg_downloads_alphabetic(df,"^b|^B")
 avg_downloads_c <- avg_downloads_alphabetic(df,"^c|^C")
 avg_downloads_d <- avg_downloads_alphabetic(df,"^d|^D")
 avg_downloads_e <- avg_downloads_alphabetic(df,"^e|^E")
 avg_downloads_f <- avg_downloads_alphabetic(df,"^f|^F")
 avg_downloads_g <- avg_downloads_alphabetic(df,"^g|^G")
 avg_downloads_h <- avg_downloads_alphabetic(df,"^h|^H")
 avg_downloads_i <- avg_downloads_alphabetic(df,"^i|^I")
 avg_downloads_j <- avg_downloads_alphabetic(df,"^j|^J")
 avg_downloads_k <- avg_downloads_alphabetic(df,"^k|^K")
 avg_downloads_l <- avg_downloads_alphabetic(df,"^l|^L")
 avg_downloads_m <- avg_downloads_alphabetic(df,"^m|^M")
 avg_downloads_n <- avg_downloads_alphabetic(df,"^n|^N")
 avg_downloads_o <- avg_downloads_alphabetic(df,"^o|^O")
 avg_downloads_p <- avg_downloads_alphabetic(df,"^p|^P")
 avg_downloads_q <- avg_downloads_alphabetic(df,"^q|^Q")
 avg_downloads_r <- avg_downloads_alphabetic(df,"^r|^R")
 avg_downloads_s <- avg_downloads_alphabetic(df,"^s|^S")
 avg_downloads_t <- avg_downloads_alphabetic(df,"^t|^T")
 avg_downloads_u <- avg_downloads_alphabetic(df,"^u|^U")
 avg_downloads_v <- avg_downloads_alphabetic(df,"^v|^V")
 avg_downloads_w <- avg_downloads_alphabetic(df,"^w|^W")
 avg_downloads_x <- avg_downloads_alphabetic(df,"^x|^X")
 avg_downloads_y <- avg_downloads_alphabetic(df,"^y|^Y")
 avg_downloads_z <- avg_downloads_alphabetic(df,"^z|^Z")
 
 avg_downloads <- rbind(avg_downloads_a,avg_downloads_b,avg_downloads_c,avg_downloads_d,avg_downloads_e,avg_downloads_f,avg_downloads_g,avg_downloads_h,avg_downloads_i,avg_downloads_j,avg_downloads_k,avg_downloads_l,avg_downloads_m,avg_downloads_n,avg_downloads_o,avg_downloads_p,avg_downloads_q,avg_downloads_r,avg_downloads_s,avg_downloads_t,avg_downloads_u,avg_downloads_v,avg_downloads_w,avg_downloads_x,avg_downloads_y,avg_downloads_z)
 
`alphabetic group` <- LETTERS[1:26] %>%
  as.data.frame()

colnames(`alphabetic group`)[1] <- 'alphabetic group'

avg_downloads <- cbind(avg_downloads,`alphabetic group`)

return(avg_downloads)
  
}

alphabetic_downloads <- get_downloads_alphabetic(pkg_random_new1)

```

From Figure \@ref(fig:ahlpha-downloads) we could see that the mean downloads of different alphabetic group are hardly affected by alphabetic order. And the highest downloaded package's name started with letter "I" or "i".

(ref:ahlpha-downloads) The average total download count of each group is little affected by the alphabetic order of package name.

```{r ahlpha-downloads,fig.cap="(ref:ahlpha-downloads)"}

alphabetic_downloads %>%
  ggplot(aes(x = `alphabetic group`,y = avg_downloads)) +
  geom_point() +
  labs( y = 'Total download counts',
    title = "Mean download counts against different alphabetic group",
    subtitle = "for 1000 random packages") +
  scale_y_log10() +
  theme_minimal()  +
  theme(panel.grid.major = element_blank()) +
  theme(
  axis.text=element_text(size=10),
  axis.title=element_text(size=12,face="bold"),
  plot.title = element_text(h = 0.5),
  plot.subtitle = element_text(h = 0.5),
  axis.title.x = element_blank())
```

```{block, type="discovery", echo = TRUE}
**Finding 2**: For 1000 random packages, 
```

Then, let's take a look for all the 1000 random packages. Figure \@ref(fig:random-boxplot) shows the data range and the median value for each alphabetic group. It can be seen that the group "i" has the highest outlier and the group "j" has the largest variation.

(ref:random-boxplot) The packages with name starting with "j" has the largest variation.

```{r random-boxplot,fig.cap="(ref:random-boxplot)"}
pkg_random_alpha <- pkg_random_new1 %>%
  arrange(package)%>%
  group_by(substr(package,1,1))

colnames(pkg_random_alpha)[4] <- "group"

ggplot(pkg_random_alpha,aes(x = group, y = count)) +
  geom_boxplot() +
  labs( y = 'Total download counts',
    title = "Total download counts against different alphabetic group",
    subtitle = "for 1000 random packages") +
  scale_y_log10() +
  theme_minimal()  +
  theme(panel.grid.major = element_blank()) +
  theme(
  axis.text=element_text(size=10),
  axis.title=element_text(size=12,face="bold"),
  plot.title = element_text(h = 0.5),
  plot.subtitle = element_text(h = 0.5),
  axis.title.x = element_blank())
```

