## Compare last year's downloads with the earliest release date

```{block, type="discovery", echo = TRUE}
**Finding**: Packages that were initially released earlier on CRAN have a higher download count in the past year. This perhaps is because in earlier times, there were fewer packages in the same category, so users had 'no choice' but to use them. Due to this, these packages accumulate a certain user base, which makes it easier to attract new users.
```


In our common cognition, we think that the earlier a package is released, the more people will know about it, and thus the more downloads it will have. However, packages related to different topics cannot be directly compared, because it is possible that the total download amount of packages in a certain topic is higher than that in another topic. Therefore, in order to test this conjecture as clearly as possible, we selected three domain packages through CRAN task view, calculated their respective downloads in the previous half a year, and found their earliest release dates for comparison.


1. Packages for Time Series Analysis

The first topic is Time Series Analysis. Time Series Analysis is a statistical technique that deals with time series data, or trend analysis. Time series data means that data is in a series of  particular time periods or intervals[@timeseries].



2. Bayesian packages for general model fitting

The second topic is Bayesian Inference. Bayesian statistics is a mathematical procedure that applies probabilities to statistical problems. It provides people the tools to update their beliefs in the evidence of new data[@bayesian].


3. Econometrics 

In order to test whether this is the case in other areas, the last topic is for econometrics packages. Econometrics is the use of statistical methods using quantitative data to develop theories or test existing hypotheses in economics or finance, which relies on techniques such as regression models and null hypothesis testing[@econometrics].

```{r vars-release-date, cache = TRUE}
# function used to get the release dates from CRAN
pkg_url <- "https://cran.r-project.org/web/packages/{pkg}/index.html"
pkg_archive <- "https://cran.r-project.org/src/contrib/Archive/{pkg}/"
releases <- function(pkg) {
      archive_dates <- tryCatch({ 
        read_html(glue(pkg_archive)) %>% 
          html_table() %>%
          .[[1]] %>% 
          pull(`Last modified`) %>% 
          ymd_hm() %>% 
          na.omit() %>% 
          as.Date()
      }, error = function(e) {
        NULL
      })
      last_update <- read_html(glue(pkg_url)) %>%
        html_table() %>% 
        .[[1]] %>% 
        filter(X1=="Published:") %>% 
        pull(X2) %>% 
        as.Date()
      
      data.frame(package = pkg, 
                 release = as.character(c(archive_dates, last_update)))
}
taskviews <- c("Econometrics", "TimeSeries", "Bayesian")
pkg_releases <- map_dfr(taskviews, ~{
    pkgs <- ctv:::.get_pkgs_from_ctv_or_repos(.x, 
                                              repos = "http://cran.rstudio.com/")[[1]]
    map_dfr(pkgs, function(x) releases(x)) %>% 
      mutate(taskview = .x)
  })
```

```{r vars-taskview-downloads, cache = TRUE}
td_start <- Sys.Date() - 365 - 2 # one year 
td_end <- Sys.Date() - 2

taskview_downloads <- map_dfr(taskviews, ~{
  pkgs <- ctv:::.get_pkgs_from_ctv_or_repos(.x, 
                                            repos = "http://cran.rstudio.com/")[[1]]
  cran_downloads(pkgs, from = td_start, to = td_end) %>% 
    mutate(taskview = .x) 
})
```

Figure \@ref(fig:release-downloads) displays the scatterplot of the last half year's download count and the earliest release date for timeseries, econometrics and bayesian packages. It can be seen that generally, as the earliest release date gets later and later, the number of download logs becomes lower and lower. And for timeseries packages, they are mainly released between 2012 and 2019. For bayesian packages, most of the packages are from 2007 to 2012. And most econometrics are centered between 2013 and 2016.  

(ref:release-downloads) The download count decrease with the initial release date.

```{r release-downloads, fig.cap="(ref:release-downloads),fig.height = 12}
initial_release <- pkg_releases %>% 
  mutate(releases = as.Date(release)) %>% 
  group_by(package) %>% 
  summarise(initial = min(releases)) %>% 
  ungroup()

taskview_downloads %>% 
  group_by(package) %>% 
  summarise(total = sum(count), 
            taskview = unique(taskview)) %>% 
  left_join(initial_release, by = "package") %>% 
  ggplot(aes(initial, total,colour = taskview)) +
  geom_point() +
  geom_smooth() +
  facet_wrap(~taskview, ncol = 1) +
  scale_y_log10() +
  labs(x = "Initial release date",
       y = "Download counts")
```


In conclusion, I'm not surprised to find that the earlier the package is released, the more downloads it will has, which is reflected in bayesian, econometrics, time series  cases. That is because, the packages released earlier will be better known. When they are released early, there may be a relatively small number of packages of the same type, so the competition is relatively small. In contrast, the packages released later can easily be covered up, because people tend to use the well-known, mature and habitual packages.

That is to say, earlier packages are more conducive to the cultivation of user habits. After all, habits are influenced by the length of time. For example, if the teacher is an old user of this group, they may recommend these packages to their students when they teach, or colleagues may prefer to recommend familiar packages when they have a good user experience. 
